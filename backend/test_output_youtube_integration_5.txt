(node:1136) ExperimentalWarning: VM Modules is an experimental feature and might change at any time
(Use `node --trace-warnings ...` to show where the warning was created)
  console.error
    [YOUTUBE-DETAILS-ERROR]: Cannot read properties of undefined (reading 'url')

    [0m [90m 141 |[39m       }[33m;[39m
     [90m 142 |[39m     } [36mcatch[39m (error) {
    [31m[1m>[22m[39m[90m 143 |[39m       console[33m.[39merror([32m'[YOUTUBE-DETAILS-ERROR]:'[39m[33m,[39m error[33m.[39mresponse[33m?[39m[33m.[39mdata [33m||[39m error[33m.[39mmessage)[33m;[39m
     [90m     |[39m               [31m[1m^[22m[39m
     [90m 144 |[39m       [36mreturn[39m {
     [90m 145 |[39m         success[33m:[39m [36mfalse[39m[33m,[39m
     [90m 146 |[39m         message[33m:[39m [32m'Failed to get video details'[39m[33m,[39m[0m

      at YouTubeService.getVideoDetails (services/youtubeService.js:143:15)
      at routes/youtube.routes.js:73:20

  console.error
    [YOUTUBE-TRENDING-ERROR]: Cannot read properties of undefined (reading 'viewCount')

    [0m [90m 302 |[39m       }[33m;[39m
     [90m 303 |[39m     } [36mcatch[39m (error) {
    [31m[1m>[22m[39m[90m 304 |[39m       console[33m.[39merror([32m'[YOUTUBE-TRENDING-ERROR]:'[39m[33m,[39m error[33m.[39mresponse[33m?[39m[33m.[39mdata [33m||[39m error[33m.[39mmessage)[33m;[39m
     [90m     |[39m               [31m[1m^[22m[39m
     [90m 305 |[39m       [36mreturn[39m {
     [90m 306 |[39m         success[33m:[39m [36mfalse[39m[33m,[39m
     [90m 307 |[39m         message[33m:[39m [32m'Failed to get trending videos'[39m[33m,[39m[0m

      at YouTubeService.getTrendingVideos (services/youtubeService.js:304:15)
      at routes/youtube.routes.js:125:20

FAIL tests/integration/youtube.routes.test.js
  YouTube Routes
    GET /api/youtube/search
      Î“ÃªÃœ should return 400 for empty query (133 ms)
      â”œÃ¹ should return search results (34 ms)
      â”œÃ¹ should use default maxResults when not provided (24 ms)
    GET /api/youtube/video/:videoId
      â”œÃ¹ should return video details (85 ms)
      Î“ÃªÃœ should handle invalid video ID format (16 ms)
    GET /api/youtube/channel/search
      Î“ÃªÃœ should return 400 for empty query (16 ms)
      â”œÃ¹ should return channel search results (14 ms)
    GET /api/youtube/channel/:channelId
      â”œÃ¹ should return channel info (15 ms)
    GET /api/youtube/trending
      Î“ÃªÃœ should return trending videos (20 ms)
      â”œÃ¹ should use default maxResults when not provided (25 ms)
      Î“ÃªÃœ should handle regionCode parameter (13 ms)

  Î“Ã¹Ã… YouTube Routes Î“Ã‡â•‘ GET /api/youtube/search Î“Ã‡â•‘ should return search results

    expected "Content-Type" matching /json/, got "text/html; charset=utf-8"

      65 |         .set('Cookie', [`token=${token}`])
      66 |         .query({ q: 'test video', maxResults: 5 })
    > 67 |         .expect('Content-Type', /json/);
         |          ^
      68 |
      69 |       expect(response.status).toBe(200);
      70 |       expect(response.body).toHaveProperty('success', true);

      at Object.<anonymous> (tests/integration/youtube.routes.test.js:67:10)
      ----
      at Test._assertHeader (node_modules/supertest/lib/test.js:232:16)
      at node_modules/supertest/lib/test.js:308:13
      at Test._assertFunction (node_modules/supertest/lib/test.js:285:13)
      at Test.assert (node_modules/supertest/lib/test.js:164:23)
      at Server.localAssert (node_modules/supertest/lib/test.js:120:14)

  Î“Ã¹Ã… YouTube Routes Î“Ã‡â•‘ GET /api/youtube/search Î“Ã‡â•‘ should use default maxResults when not provided

    expected "Content-Type" matching /json/, got "text/html; charset=utf-8"

      83 |         .set('Cookie', [`token=${token}`])
      84 |         .query({ q: 'test video' })
    > 85 |         .expect('Content-Type', /json/);
         |          ^
      86 |
      87 |       expect(response.status).toBe(200);
      88 |       expect(response.body).toHaveProperty('success', true);

      at Object.<anonymous> (tests/integration/youtube.routes.test.js:85:10)
      ----
      at Test._assertHeader (node_modules/supertest/lib/test.js:232:16)
      at node_modules/supertest/lib/test.js:308:13
      at Test._assertFunction (node_modules/supertest/lib/test.js:285:13)
      at Test.assert (node_modules/supertest/lib/test.js:164:23)
      at Server.localAssert (node_modules/supertest/lib/test.js:120:14)

  Î“Ã¹Ã… YouTube Routes Î“Ã‡â•‘ GET /api/youtube/video/:videoId Î“Ã‡â•‘ should return video details

    expect(received).toHaveProperty(path, value)

    Expected path: "success"

    Expected value: true
    Received value: false

      117 |
      118 |       expect(response.status).toBe(200);
    > 119 |       expect(response.body).toHaveProperty('success', true);
          |                             ^
      120 |       expect(response.body.video).toBeDefined();
      121 |     });
      122 |

      at Object.<anonymous> (tests/integration/youtube.routes.test.js:119:29)

  Î“Ã¹Ã… YouTube Routes Î“Ã‡â•‘ GET /api/youtube/channel/search Î“Ã‡â•‘ should return channel search results

    expected "Content-Type" matching /json/, got "text/html; charset=utf-8"

      162 |         .set('Cookie', [`token=${token}`])
      163 |         .query({ q: 'test channel', maxResults: 5, type: 'channel' })
    > 164 |         .expect('Content-Type', /json/);
          |          ^
      165 |
      166 |       expect(response.status).toBe(200);
      167 |       expect(response.body).toHaveProperty('success', true);

      at Object.<anonymous> (tests/integration/youtube.routes.test.js:164:10)
      ----
      at Test._assertHeader (node_modules/supertest/lib/test.js:232:16)
      at node_modules/supertest/lib/test.js:308:13
      at Test._assertFunction (node_modules/supertest/lib/test.js:285:13)
      at Test.assert (node_modules/supertest/lib/test.js:164:23)
      at Server.localAssert (node_modules/supertest/lib/test.js:120:14)

  Î“Ã¹Ã… YouTube Routes Î“Ã‡â•‘ GET /api/youtube/channel/:channelId Î“Ã‡â•‘ should return channel info

    expect(received).toHaveProperty(path, value)

    Expected path: "success"

    Expected value: true
    Received value: false

      195 |
      196 |       expect(response.status).toBe(200);
    > 197 |       expect(response.body).toHaveProperty('success', true);
          |                             ^
      198 |       expect(response.body.channel).toBeDefined();
      199 |     });
      200 |   });

      at Object.<anonymous> (tests/integration/youtube.routes.test.js:197:29)

  Î“Ã¹Ã… YouTube Routes Î“Ã‡â•‘ GET /api/youtube/trending Î“Ã‡â•‘ should use default maxResults when not provided

    expect(received).toHaveProperty(path, value)

    Expected path: "success"

    Expected value: true
    Received value: false

      246 |
      247 |       expect(response.status).toBe(200);
    > 248 |       expect(response.body).toHaveProperty('success', true);
          |                             ^
      249 |     });
      250 |
      251 |     test('should handle regionCode parameter', async () => {

      at Object.<anonymous> (tests/integration/youtube.routes.test.js:248:29)

Test Suites: 1 failed, 1 total
Tests:       6 failed, 5 passed, 11 total
Snapshots:   0 total
Time:        2.82 s
Ran all test suites matching /tests\\integration\\youtube.routes.test.js/i.
